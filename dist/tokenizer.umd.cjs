(function(i){typeof define=="function"&&define.amd?define(i):i()})(function(){"use strict";var N=Object.defineProperty;var v=(i,r,o)=>r in i?N(i,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[r]=o;var c=(i,r,o)=>v(i,typeof r!="symbol"?r+"":r,o);const i=Symbol("newline"),r=Symbol("blank");class o{constructor(s,t="",e=1,h=1,l=1){c(this,"name");c(this,"value");c(this,"line");c(this,"start");c(this,"end");this.name=s,this.value=t,this.line=e,this.start=h,this.end=l}get length(){return this.value.length}}class d extends Array{pushToLatestTextNode(s){let t=this[this.length-1];t?(t==null?void 0:t.name)!==r?this.push(t=new o(r,"",t.line,t.ends,t.ends)):t.end+=s.length:this.push(t=new o(r)),t.value+=s}push(s){const t=this[this.length-1];return t&&(s.start=t.end,s.line=t.line+s.value.split(`
`).length-1,s.end=s.start+s.value.length),super.push(s)}}var f=Object.defineProperty,w=(n,s,t)=>s in n?f(n,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[s]=t,u=(n,s,t)=>w(n,typeof s!="symbol"?s+"":s,t);class g{constructor(s){u(this,"BEGINNING",Symbol("beginning")),u(this,"ENDING",Symbol("ending")),u(this,"raw",""),u(this,"cursor",0),this.raw=s}get current(){return this.raw[this.cursor]}get next(){return this.raw[++this.cursor]}get prev(){return this.raw[--this.cursor]}matches(s){return this.raw.slice(this.cursor,this.cursor+s.length)===s}before(s){return this.raw.slice(this.cursor-s.length,this.cursor)===s}after(s){return this.raw.slice(this.cursor+1,this.cursor+s.length+1)===s}distanceTo(s){const t=s===this.BEGINNING?this.cursor:s===this.ENDING?this.raw.length-this.cursor-1:this.raw.indexOf(s,this.cursor)-this.cursor-1;return t<0?1/0:t}closest(s){return s.map(t=>[t,this.distanceTo(t)]).sort((t,e)=>t[1]-e[1])}startTransaction(){const{cursor:s}=this;function t(){this.cursor=s}return t.bind(this)}getUntil(s){const t=this.raw.indexOf(s,this.cursor);if(t===-1)return;const e=this.raw.slice(this.cursor,t);return this.cursor+=e.length,e}slice(s){if(s<0)throw new RangeError(`Cannot slice backwards from ${this.cursor} to ${s}.`);const t=this.raw.slice(this.cursor,this.cursor+s);return this.cursor=s===1/0?this.raw.length:this.cursor+s,t}move(s){return this.cursor+=s,this}moveTo(s){return this.cursor=s,this}jumpTo(s){return this.cursor=this.raw.indexOf(s,this.cursor)}consume(s){let t;const e=this.cursor;for(Array.isArray(s)||(s=[s]);(t=s.findIndex(h=>this.matches(h)))>-1;)this.move(s[t].length);return this.raw.slice(e,this.cursor)}}function m(n,s){const t=new d,e=new g(n);do{let h;for(const[l,a]of s)e.matches(a)&&(h=new o,h.name=l,h.value=a,t.push(h),e.cursor+=a.length-1);h||t.pushToLatestTextNode(e.current)}while(e.next!==void 0);return t}const b=Symbol("space"),p=Symbol("exclamation");console.log(m("hello world!",[[b," "],[Symbol("double asterix"),"**"],[i,`
`],[p,"!"]]))});
